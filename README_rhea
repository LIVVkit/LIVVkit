Information on how to run the Land Ice V&V (LIVV) Post-Processing Software.
KJE, AB, NM 5/2014

The /PISCEES/trunk/tests/higher-order/livv/ directory contains all the scripts and code to run LIVV.
The rhea_VV.bash script contains the inputs needed to run on a data processing style machine (OLCF).
The rhea script is run after the model is built and run on Titan (OLCF). Then you will switch over to Rhea (OLCF).
Scripts for Carver (NERSC) and Mac OSX (local) are provided.

If you want to run on another machine, these are the software packages and versions that worked 
on both NERSC and OLCF machines as of 12/2013:
	    1. hdf5/1.8.6
	    2. python/2.7.3
	    3. netcdf4-python/1.0 (NERSC is 1.0.6)
	    4. python_numpy/1.7.1            
	    5. ncl/6.0.0  (at NERSC this is called, inexplicably, ncar/6.0.0)  
	    6. nco/4.0.7 (NERSC is 4.3.6)
      7. netcdf/4.1.3 (NERSC is 4.2.1.1)

Filepaths for the python script are defined in the rhea_VV.bash script, and most are required.
The paths that need input from the user are between the ************************ lines.
The command to run the python script along with all of the necessary/optional files is the last line of the script. 

/livv/bin: the python processing code 
/livv/plots: the ncl scripts 
/livv/data: the solver data from each processed run is placed here automatically in a $case.asc format 

To run the rhea_VV.bash script:

  1. Make sure to place "source $MODULESHOME/init/bash" in your .bashrc file.

  2. Create a higher-order directory in your scratch space if there is not one already.
     Place $TEST_DIR=$location_of_higher_order_directory in your .bashrc file in your home space and source it.
     (This should already be done for /PISCEES/trunk/builds/titan-gnu/titan-gnu-build-and-test.csh file which will
     be run on Titan before you run LIVV on Rhea.)

Log onto Titan:

  3. Now run the /PISCEES/trunk/builds/titan-gnu/titan-gnu-build-and-test.csh file on Titan (see /PISCEES/trunk/builds/README
     for more information on how to run the csh script). NOTE: This updated .csh file will now copy over the most recent
     /PISCEES/trunk/tests/higher-order/livv directory as well as the latest reg_test and perf_test directories located in /ccs/proj/cli062.
     You can turn off the copying of these scripts in the titan-gnu-build-and-test.csh file at the beginning if you don't want them
     copied over. The script will now update your job submissions in reg_test to the screen and will not finish until all jobs have
     finished running. Thus, you can automatically switch over to rhea and run LIVV once the above file has completed.
     Make sure the $TEST_DIR is set to the directory that you created in step #2. Also make sure the tests you want to run
     and analyze on your machine later are selected in the csh file. The jobs in reg_test (and perf_test if the flag is selected)
     will be automatically run by this csh script (as long as the $TEST_DIR path is correctly specified) after the model is
     successfuly built.

Log onto Rhea (We are hoping to incorporate cross-submission capability soon that will allow LIVV to be run automatically from Titan
after the file in step 3 has finished running):
  To set up the LIVV executable /higher-order/livv/rhea_VV.bash:
  (This can be done after you run the titan-gnu-build-and-test.csh file.)

  4. There is an opportunity to insert a COMMENT to display your reason for running LIVV on the website.

  5. Change the TEST_FILEPATH to the path containing the higher-order directory (the directory mentioned in step #2).
     NOTE: This path is currently set to $TEST_DIR which should require no changing by the user, unless it is not set properly.

  6. Change the HTML_PATH to the location of the www directory. If it doesn't already exist, specify the path to where
     you would like it and LIVV will check the path and create it if it is not already there. For Titan/Rhea users, this is
     the www directory in your home space where your html files can be viewed on users.nccs.gov. LIVV will also create a
     sub-directory where it will store all of its own html files, therefore not disrupting the rest of your workspace.

  7. The verification flag options are listed and you may set the flags to however you would prefer, 0 = do not run, 1 = run. 

  8. The performance flag options are listed and you may set the flags to however you would prefer, 0 = do not run, 1 = run.
  
  8. The verification flag option is listed and you may set the flag to however you would prefer, 0 = do not run, 1 = run.

  9. RUN_ANT should be left as it is since Antartica analysis is not set up yet.

To run LIVV (on Rhea!):

  10. Type "bash rhea_VV.bash" in the command line in the /higher-order/livv/ directory. NOTE: This can only be done once the Titan
      script has finished running, or you will get an error. When it is finished running, the website location will be printed to
      the screen where you can go look at the output. We have piped the ncl plot output to a file called plot_details.out. So if
      there is any concern over whether plots have formed correctly after inspecting the website, you can look in that file.
      Same for the iteration plots in iter_details.out.




TODOs (feel free to add to this as needed)

Major:
*create a more general user interface to process the GIS production output
*enable the option to read from FELIX data (in exodus format) using visit

Minor:
*have the input and output information from the benchmark runs set in the software rather than the user 
specify (or at least have a default)
*parse more detailed data from the output files about the solver and preconditioner
n VV_outprocess
